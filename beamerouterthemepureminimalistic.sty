\ProvidesPackage{beamerouterthemepureminimalistic}
\RequirePackage{ifthen}
\RequirePackage{etoolbox}
\RequirePackage{calc}

\mode<presentation>

\newboolean{showmaxslides}
\setboolean{showmaxslides}{false}

\DeclareOptionBeamer{showmaxslides}{\setboolean{showmaxslides}{true}}
\ProcessOptionsBeamer

% invertcolor is already processed in colortheme
\ifthenelse{\boolean{darkmode}}{%
  \newcommand{\headerpath}{logos/header_logo_darkmode}
  \newcommand{\institutepath}{logos/institute_logo_darkmode}
}{%
  \newcommand{\headerpath}{logos/header_logo}
  \newcommand{\institutepath}{logos/institute_logo}
}
%%%%%%%%%%%%%%%%%%%%%% CHANGE HERE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Change these commands if your logos are not displaying nicely
%%%%% I am still trying to figure out how these options could be easily accessed
%%%%% by a user
%%%%% Note, that all logos are embedded in boxes.
% The header shares the horizontal space with the frame title in normal mode
% a value between .5 and .8 should be usually required
\newcommand{\logoheadercommand}{\includegraphics[width=.5\linewidth]{\headerpath}}
% For the title page, the logo is embedded in the total frame, meaning that \linewidth
% here refers to the complete \paperwidth, small value < .4 are usually required.
\newcommand{\logoheaderlargecommand}{\includegraphics[width=.2\paperwidth]{\headerpath}}
% The footer will only use part of the space under the line. Usually almost the
% full linewidth should be used
\newcommand{\logofootercommand}{\includegraphics[width=.8\linewidth]{\institutepath}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\defbeamertemplate*{frametitle}{largetitle}{
    \logoheaderlargecommand
}

\newlength{\myleftmargin}
\setlength{\myleftmargin}{.0625\paperwidth}
\newlength{\myrightmargin}
\setlength{\myrightmargin}{.0625\paperwidth}
\newlength{\mytextlength}
\setlength{\mytextlength}{\paperwidth - \myleftmargin - \myrightmargin}
\newlength{\myfooterheight}
\setlength{\myfooterheight}{.08\paperheight}

\setbeamersize{text margin left=\myleftmargin, text margin right=\myrightmargin}

\defbeamertemplate*{frametitle}{pureminimalistictitle}{
  \vskip 10pt
  \leavevmode
  \begin{beamercolorbox}[sep=0ex, wd=.65\paperwidth, left]{frametitle}
    \usebeamerfont{frametitle}%
    \insertframetitle%
  \end{beamercolorbox}%
  \begin{beamercolorbox}[sep=0pt, wd=.2\paperwidth, right]{headline}
    \logoheadercommand
  \end{beamercolorbox}
}%

\defbeamertemplate*{footline}{pureminimalisticfooter}{%
  \leavevmode
  \begin{beamercolorbox}[sep=0pt, wd=\myleftmargin, ht=\myfooterheight, dp=1ex]{footline}
  \end{beamercolorbox}%
  \begin{beamercolorbox}[sep=0pt, wd=\mytextlength, ht=\myfooterheight, dp=1ex]{footline}
    \parbox{\linewidth}%
    % Don't ask me why I had to insert a space/character after \usebeamercolor
    % for it to have an effect on \hrule. Same goes for \color{white} \hrule
    { \usebeamercolor[fg]{normal text}\ \hrule }
    \leavevmode
    \begin{beamercolorbox}[sep=0mm, wd=.6\paperwidth, ht=\myfooterheight]{footline}%
      \usebeamerfont{footline}%
      \vbox to\myfooterheight{%
        \vfil%
        \insertshorttitle{} $~|~$ %
        \insertshortauthor{} $\quad$ %
        \insertshortsubtitle{}\par%
        Page \insertframenumber\ifthenelse{%
        \boolean{showmaxslides}}%
        {/\inserttotalframenumber}%
        {}\par%
        \vfil%
        \vfil%
      }%
      \end{beamercolorbox}%
      \begin{beamercolorbox}[sep=0mm, wd=.275\paperwidth,right, ht=\myfooterheight]{footline}
        \vbox to\myfooterheight{%
          \vfil%
          \logofootercommand
          \vfil%
          \vfil%
        }%
      \end{beamercolorbox}%
    \end{beamercolorbox}%
  \begin{beamercolorbox}[sep=0pt, wd=\myrightmargin, dp=1ex, ht=\myfooterheight]{footline}
  \end{beamercolorbox}
}

\mode<all>